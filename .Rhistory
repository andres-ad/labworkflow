writeData(wb, sheet = "Modifications", x = data_to_append, startRow = nrows + 1, colNames = FALSE)
protectSheet(wb, sheet = "Modifications", password = "armmorlab2023!")
saveWorkbook(wb, local_cache_path, overwrite = TRUE)
print("Excel file has been updated")
tryCatch({
write_all_sheets_to_google(google_sheet_url,local_database)
},error = function(e) {
warning("Could not connect to internet, online copy may now be corrupted, which is ok if you reinitialize the App")
})
}
update_database <- function(local_database,local_cache_path,tab,google_sheet_url){
# Update sheet in excel file
wb <- loadWorkbook(local_cache_path)
writeData(wb, sheet = tab, x = local_database[[tab]], overwrite = TRUE)
protectSheet(wb, sheet = tab, password = "armmorlab2023!")
# Add row to Modifications
nrows <- nrow(readWorkbook(excel_file_path, sheet = "Modifications"))
data_to_append <- data.frame(DateTime = date_time, Tab = tab)
writeData(wb, sheet = "Modifications", x = data_to_append, startRow = nrows + 1, colNames = FALSE)
protectSheet(wb, sheet = "Modifications", password = "armmorlab2023!")
saveWorkbook(wb, local_cache_path, overwrite = TRUE)
print("Excel file has been updated")
tryCatch({
write_all_sheets_to_google(goovgle_sheet_url,local_database)
},error = function(e) {
warning("Could not connect to internet, online copy may now be corrupted, which is ok if you reinitialize the App")
})
}
update_database(local_database,local_cache_path,tab,google_sheet_url)
update_database(local_database,local_cache_path,tab,google_sheet_url)
update_database <- function(local_database,local_cache_path,tab,google_sheet_url){
# Update sheet in excel file
wb <- loadWorkbook(local_cache_path)
writeData(wb, sheet = tab, x = local_database[[tab]])
protectSheet(wb, sheet = tab, password = "armmorlab2023!")
# Add row to Modifications
nrows <- nrow(readWorkbook(excel_file_path, sheet = "Modifications"))
data_to_append <- data.frame(DateTime = date_time, Tab = tab)
writeData(wb, sheet = "Modifications", x = data_to_append, startRow = nrows + 1, colNames = FALSE)
protectSheet(wb, sheet = "Modifications", password = "armmorlab2023!")
saveWorkbook(wb, local_cache_path, overwrite = TRUE)
print("Excel file has been updated")
tryCatch({
write_all_sheets_to_google(goovgle_sheet_url,local_database)
},error = function(e) {
warning("Could not connect to internet, online copy may now be corrupted, which is ok if you reinitialize the App")
})
}
update_database(local_database,local_cache_path,tab,google_sheet_url)
update_database <- function(local_database,local_cache_path,tab,google_sheet_url){
# Update sheet in excel file
wb <- loadWorkbook(local_cache_path)
writeData(wb, sheet = tab, x = local_database[[tab]])
protectWorkSheet(wb, sheet = tab, password = "armmorlab2023!")
# Add row to Modifications
nrows <- nrow(readWorkbook(excel_file_path, sheet = "Modifications"))
data_to_append <- data.frame(DateTime = date_time, Tab = tab)
writeData(wb, sheet = "Modifications", x = data_to_append, startRow = nrows + 1, colNames = FALSE)
protectSheet(wb, sheet = "Modifications", password = "armmorlab2023!")
saveWorkbook(wb, local_cache_path, overwrite = TRUE)
print("Excel file has been updated")
tryCatch({
write_all_sheets_to_google(goovgle_sheet_url,local_database)
},error = function(e) {
warning("Could not connect to internet, online copy may now be corrupted, which is ok if you reinitialize the App")
})
}
update_database(local_database,local_cache_path,tab,google_sheet_url)
update_database <- function(local_database,local_cache_path,tab,google_sheet_url){
# Update sheet in excel file
wb <- loadWorkbook(local_cache_path)
writeData(wb, sheet = tab, x = local_database[[tab]])
protectWorksheet(wb, sheet = tab, password = "armmorlab2023!")
# Add row to Modifications
nrows <- nrow(readWorkbook(excel_file_path, sheet = "Modifications"))
data_to_append <- data.frame(DateTime = date_time, Tab = tab)
writeData(wb, sheet = "Modifications", x = data_to_append, startRow = nrows + 1, colNames = FALSE)
protectSheet(wb, sheet = "Modifications", password = "armmorlab2023!")
saveWorkbook(wb, local_cache_path, overwrite = TRUE)
print("Excel file has been updated")
tryCatch({
write_all_sheets_to_google(goovgle_sheet_url,local_database)
},error = function(e) {
warning("Could not connect to internet, online copy may now be corrupted, which is ok if you reinitialize the App")
})
}
update_database(local_database,local_cache_path,tab,google_sheet_url)
update_database <- function(local_database,local_cache_path,tab,google_sheet_url){
# Update sheet in excel file
wb <- loadWorkbook(local_cache_path)
writeData(wb, sheet = tab, x = local_database[[tab]])
protectWorksheet(wb, sheet = tab, password = "armmorlab2023!")
# Add row to Modifications
nrows <- nrow(readWorkbook(local_cache_path, sheet = "Modifications"))
data_to_append <- data.frame(DateTime = date_time, Tab = tab)
writeData(wb, sheet = "Modifications", x = data_to_append, startRow = nrows + 1, colNames = FALSE)
protectSheet(wb, sheet = "Modifications", password = "armmorlab2023!")
saveWorkbook(wb, local_cache_path, overwrite = TRUE)
print("Excel file has been updated")
tryCatch({
write_all_sheets_to_google(goovgle_sheet_url,local_database)
},error = function(e) {
warning("Could not connect to internet, online copy may now be corrupted, which is ok if you reinitialize the App")
})
}
update_database(local_database,local_cache_path,tab,google_sheet_url)
update_database <- function(local_database,local_cache_path,tab,google_sheet_url){
# Update sheet in excel file
wb <- loadWorkbook(local_cache_path)
writeData(wb, sheet = tab, x = local_database[[tab]])
protectWorksheet(wb, sheet = tab, password = "armmorlab2023!")
# Add row to Modifications
nrows <- nrow(readWorkbook(local_cache_path, sheet = "Modifications"))
data_to_append <- data.frame(DateTime = format(Sys.time(), "%Y-%m-%d %H:%M:%S"), Tab = tab)
writeData(wb, sheet = "Modifications", x = data_to_append, startRow = nrows + 1, colNames = FALSE)
protectSheet(wb, sheet = "Modifications", password = "armmorlab2023!")
saveWorkbook(wb, local_cache_path, overwrite = TRUE)
print("Excel file has been updated")
tryCatch({
write_all_sheets_to_google(goovgle_sheet_url,local_database)
},error = function(e) {
warning("Could not connect to internet, online copy may now be corrupted, which is ok if you reinitialize the App")
})
}
update_database(local_database,local_cache_path,tab,google_sheet_url)
update_database <- function(local_database,local_cache_path,tab,google_sheet_url){
# Update sheet in excel file
wb <- loadWorkbook(local_cache_path)
writeData(wb, sheet = tab, x = local_database[[tab]])
protectWorksheet(wb, sheet = tab, password = "armmorlab2023!")
# Add row to Modifications
nrows <- nrow(readWorkbook(local_cache_path, sheet = "Modifications"))
data_to_append <- data.frame(DateTime = format(Sys.time(), "%Y-%m-%d %H:%M:%S"), Tab = tab)
writeData(wb, sheet = "Modifications", x = data_to_append, startRow = nrows + 1, colNames = FALSE)
protectWorksheet(wb, sheet = "Modifications", password = "armmorlab2023!")
saveWorkbook(wb, local_cache_path, overwrite = TRUE)
print("Excel file has been updated")
tryCatch({
write_all_sheets_to_google(goovgle_sheet_url,local_database)
},error = function(e) {
warning("Could not connect to internet, online copy may now be corrupted, which is ok if you reinitialize the App")
})
}
update_database(local_database,local_cache_path,tab,google_sheet_url)
# Update sheet in excel file
wb <- loadWorkbook(local_cache_path)
writeData(wb, sheet = tab, x = local_database[[tab]])
protectWorksheet(wb, sheet = tab, password = "armmorlab2023!")
nrows <- nrow(readWorkbook(local_cache_path, sheet = "Modifications"))
data_to_append <- data.frame(DateTime = format(Sys.time(), "%Y-%m-%d %H:%M:%S"), Tab = tab)
writeData(wb, sheet = "Modifications", x = data_to_append, startRow = nrows + 1, colNames = FALSE)
protectWorksheet(wb, sheet = "Modifications", password = "armmorlab2023!")
saveWorkbook(wb, local_cache_path, overwrite = TRUE)
local_cache_path
saveWorkbook(wb, local_cache_path, overwrite = TRUE)
print("Excel file has been updated")
tryCatch({
write_all_sheets_to_google(goovgle_sheet_url,local_database)
},error = function(e) {
warning("Could not connect to internet, online copy may now be corrupted, which is ok if you reinitialize the App")
})
local_cache_path
local_database
local_database = read_all_sheets(local_cache_path)
local_database
update_database(local_database,local_cache_path,tab,google_sheet_url)
local_cache_path
tab
wb <- loadWorkbook(local_cache_path)
writeData(wb, sheet = tab, x = local_database[[tab]])
protectWorksheet(wb, sheet = tab, password = "armmorlab2023!")
# Add row to Modifications
nrows <- nrow(readWorkbook(local_cache_path, sheet = "Modifications"))
data_to_append <- data.frame(DateTime = format(Sys.time(), "%Y-%m-%d %H:%M:%S"), Tab = tab)
data_to_append
writeData(wb, sheet = "Modifications", x = data_to_append, startRow = nrows + 1, colNames = FALSE)
protectWorksheet(wb, sheet = "Modifications", password = "armmorlab2023!")
saveWorkbook(wb, local_cache_path, overwrite = TRUE)
local_database = read_all_sheets(local_cache_path)
local_database
nrows
wb
tab = "Receiving"
# Update sheet in excel file
wb <- loadWorkbook(local_cache_path)
writeData(wb, sheet = tab, x = local_database[[tab]])
protectWorksheet(wb, sheet = tab, password = "armmorlab2023!")
nrows <- nrow(readWorkbook(local_cache_path, sheet = "Modifications"))
data_to_append <- data.frame(DateTime = format(Sys.time(), "%Y-%m-%d %H:%M:%S"), Tab = tab)
writeData(wb, sheet = "Modifications", x = data_to_append, startRow = nrows + 1, colNames = FALSE)
protectWorksheet(wb, sheet = "Modifications", password = "armmorlab2023!")
saveWorkbook(wb, local_cache_path, overwrite = TRUE)
saveWorkbook(wb, local_cache_path, overwrite = TRUE)
readWorkbook(local_cache_path, sheet = "Modifications")
readWorkbook(wb)
readWorkbook(wb,sheet = "Modifications")
# Update sheet in excel file
wb <- loadWorkbook(local_cache_path)
nrows <- nrow(readWorkbook(local_cache_path, sheet = "Modifications"))
nrows
data_to_append <- data.frame(DateTime = format(Sys.time(), "%Y-%m-%d %H:%M:%S"), Tab = tab)
nrows + 1
writeData(wb, sheet = "Modifications", x = data_to_append, startRow = nrows + 1, colNames = FALSE)
readWorkbook(wb,sheet = "Modifications")
writeData(wb, sheet = "Modifications", x = data_to_append, startRow = nrows + 2, colNames = FALSE)
readWorkbook(wb,sheet = "Modifications")
update_database <- function(local_database,local_cache_path,tab,google_sheet_url){
# Update sheet in excel file
wb <- loadWorkbook(local_cache_path)
writeData(wb, sheet = tab, x = local_database[[tab]])
protectWorksheet(wb, sheet = tab, password = "armmorlab2023!")
# Add row to Modifications
nrows <- nrow(readWorkbook(local_cache_path, sheet = "Modifications"))
data_to_append <- data.frame(DateTime = format(Sys.time(), "%Y-%m-%d %H:%M:%S"), Tab = tab)
writeData(wb, sheet = "Modifications", x = data_to_append, startRow = nrows + 2, colNames = FALSE)
protectWorksheet(wb, sheet = "Modifications", password = "armmorlab2023!")
saveWorkbook(wb, local_cache_path, overwrite = TRUE)
print("Excel file has been updated")
tryCatch({
write_all_sheets_to_google(google_sheet_url,local_database)
},error = function(e) {
warning("Could not connect to internet, online copy may now be corrupted, which is ok if you reinitialize the App")
})
}
update_database(local_database,local_cache_path,tab,google_sheet_url)
update_database(local_database,local_cache_path,tab,google_sheet_url)
write_all_sheets_to_google(google_sheet_url,local_database)
?try
sheet_data
gs
sheet_names(gs)
write_all_sheets_to_google <- function(google_sheet_url,local_database){
gs <- gs4_get(google_sheet_url)
for(sheet_name in names(local_database)) {
sheet_data <- local_database[[sheet_name]]
# Delete the existing sheet
if(sheet_name %in% sheet_names(gs)){
sheet_delete(gs, sheet = sheet_name)
}
sheet_add(gs, sheet = sheet_name)
# Add a new sheet and write the data
write_sheet(gs, data = sheet_data, sheet = sheet_name)
}
# Optionally, print a success message
print("Online database has been updated with local data.")
}
update_database <- function(local_database,local_cache_path,tab,google_sheet_url){
# Update sheet in excel file
wb <- loadWorkbook(local_cache_path)
writeData(wb, sheet = tab, x = local_database[[tab]])
protectWorksheet(wb, sheet = tab, password = "armmorlab2023!")
# Add row to Modifications
nrows <- nrow(readWorkbook(local_cache_path, sheet = "Modifications"))
data_to_append <- data.frame(DateTime = format(Sys.time(), "%Y-%m-%d %H:%M:%S"), Tab = tab)
writeData(wb, sheet = "Modifications", x = data_to_append, startRow = nrows + 2, colNames = FALSE)
protectWorksheet(wb, sheet = "Modifications", password = "armmorlab2023!")
saveWorkbook(wb, local_cache_path, overwrite = TRUE)
tryCatch({
write_all_sheets_to_google(google_sheet_url,local_database)
},error = function(e) {
warning("Could not connect to internet, online copy may now be corrupted, which is ok if you reinitialize the App")
})
}
library(shiny)
runApp()
runApp()
runApp()
app_environment <- "testing"
app_environment <- "testing"
runApp()
lapply(list.files("global",pattern="\\.R$",full.names = TRUE),
source)
lapply(list.files("global",pattern="\\.R$",full.names = TRUE),
source)
app_environment <- "testing" # Change to production for the real world version
lapply(libraries, library, character.only = TRUE)
libraries <- c("shiny", "shinyjs", "rhandsontable",
"DT", "writexl", "tidyverse",
"googlesheets4","gargle",
"googledrive","shinyalert",
"webshot","htmlTable","grid",
"gridExtra","readxl","openxlsx")
app_environment <- "testing" # Change to production for the real world version
lapply(libraries, library, character.only = TRUE)
library("webshot")
# source functions for UI and server in their respective folders
lapply(list.files("ui_components",pattern="\\.R$",full.names = TRUE),
source)
lapply(list.files("server_functions",pattern="\\.R$",full.names = TRUE),
source)
lapply(list.files("global",pattern="\\.R$",full.names = TRUE),
source)
list.files("global",pattern="\\.R$",full.names = TRUE)
lapply(list.files("global",pattern="\\.R$",full.names = TRUE),
source)
lapply(list.files("global",pattern="\\.R$",full.names = TRUE),
source)
lapply(list.files("global",pattern="\\.R$",full.names = TRUE),
source)
app_environment <- "testing" # Change to production for the real world version
lapply(list.files("global",pattern="\\.R$",full.names = TRUE), function(file) {
source(file, local = list(app_environment = app_environment))
})
app_environment <- "testing" # Change to production for the real world version
lapply(list.files("global",pattern="\\.R$",full.names = TRUE), function(file) {
source(file, local = list(app_environment = app_environment))
})
source(file, local = env)
lapply(list.files("global", pattern="\\.R$", full.names = TRUE), function(file) {
env <- new.env()
env$app_environment <- app_environment
source(file, local = env)
})
app_environment <- "testing" # Change to production for the real world version
lapply(libraries, library, character.only = TRUE)
libraries <- c("shiny", "shinyjs", "rhandsontable",
"DT", "writexl", "tidyverse",
"googlesheets4","gargle",
"googledrive","shinyalert",
"webshot","htmlTable","grid",
"gridExtra","readxl","openxlsx")
app_environment <- "testing" # Change to production for the real world version
lapply(libraries, library, character.only = TRUE)
# source functions for UI and server in their respective folders
lapply(list.files("ui_components",pattern="\\.R$",full.names = TRUE),
source)
lapply(list.files("server_functions",pattern="\\.R$",full.names = TRUE),
source)
lapply(list.files("global", pattern="\\.R$", full.names = TRUE), function(file) {
env <- new.env()
env$app_environment <- app_environment
source(file, local = env)
})
runApp()
library(shiny)
runApp()
soutce("global/global_variables.R")
source("global/global_variables.R")
library(shiny)
runApp()
source("global/database_handling.R")
local_database_path
source("global/database_handling.R")
runApp()
runApp()
runApp()
runApp()
google_sheet_url
google_sheet_url = get_google_sheet_url(app_environment)
app_environment <- "testing" # Change to production for the real world version
local_database_path = get_local_database_paths(app_environment)
google_sheet_url = get_google_sheet_url(app_environment)
local_database = read_all_sheets(local_database_path)
tryCatch({
online_database = read_all_sheets_from_google(google_sheet_url)
online <- TRUE
}, error = function(e) {
warning("Could not connect to internet, using local copy")
})
local_database_last_modification = local_database[["Modifications"]]$DateTime[nrow(local_database[["Modifications"]])]
online_database_last_modification = online_database[["Modifications"]]$DateTime[nrow(online_database[["Modifications"]])]
local_database_last_modification
online_database_last_modification
local_database_last_modification>online_database_last_modification
is.null(online_database_last_modification)local_database_last_modification>online_database_last_modification
is.null(online_database_last_modification)
online_database_last_modification
is.null(online_database_last_modification) || local_database_last_modification>online_database_last_modification
library(shiny)
runApp()
library(timeout)
install.packages("timeout")
runApp()
runApp()
runApp()
runApp()
local_database_last_modification = local_database[["Modifications"]]$DateTime[nrow(local_database[["Modifications"]])]
local_database = read_all_sheets(local_database_path)
get_local_database_paths <- function(app_environment){
local_database_paths <- list(
testing = "C:/Data/NICD/DatabaseTesting.xlsx",
production = "C:/Data/NICD/Database.xlsx"
)
local_database_path <- local_database_paths[[app_environment]]
return(local_database_path)
}
app_environment <- "testing" # Change to production for the real world version
local_database_path = get_local_database_paths(app_environment)
google_sheet_url = get_google_sheet_url(app_environment)
local_database = read_all_sheets(local_database_path)
online_database = read_all_sheets_from_google(google_sheet_url)
online <- TRUE
local_database_last_modification = local_database[["Modifications"]]$DateTime[nrow(local_database[["Modifications"]])]
online_database_last_modification = online_database[["Modifications"]]$DateTime[nrow(online_database[["Modifications"]])]
local_database_last_modification>online_database_last_modification
local_database_last_modification
online_database_last_modification
library(rshiny)
library(shiny)
runApp()
app_environment <- "testing" # Change to production for the real world version
local_database_path = get_local_database_paths(app_environment)
google_sheet_url = get_google_sheet_url(app_environment)
database_data <- initialize_app(google_sheet_url,local_database_path)
database_data
database_data[["Receiving"]]
database_data <- initialize_app(google_sheet_url,local_database_path)
database_data[["Receiving"]]
database_data[["Receiving"]][["REV"]]
gsub("REV","",database_data[["Receiving"]][["REV"]])
global_get_default_value <- function(sheet_name, pattern) {
1 + suppressWarnings(max(as.numeric(gsub(pattern, "", database_data[[sheet_name]][[pattern]])), na.rm = TRUE))
}
global_get_default_rec_value <- function() {
global_get_default_value("Receiving", "REV")
}
global_get_default_rec_value()
library(shiny)
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
database_data
report_df
database_data[["Receiving"]]
runApp()
runApp()
runApp()
runApp()
runApp()
source("global/global_variables.R")
local_database_path
google_sheet_url
local_database = read_all_sheets(local_database_path)
gs <- gs4_get(url)
gs <- gs4_get(url)
url
gs <- gs4_get(google_sheet_url)
modifications_online_sheet = read_sheet(gs, sheet = "Modifications")
local_database_last_modification = local_database[["Modifications"]]$DateTime[nrow(local_database[["Modifications"]])]
online_database_last_modification = modifications_online_sheet$DateTime[nrow(modifications_online_sheet)]
is.null(online_database_last_modification) || local_database_last_modification>online_database_last_modification
local_database_last_modification == online_database_last_modification
library(shiny)
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
app_environment <- "testing" # Change to production for the real world version
local_database_path = get_local_database_paths(app_environment)
google_sheet_url = get_google_sheet_url(app_environment)
database_data <- initialize_app(google_sheet_url,local_database_path)
# Update sheet in excel file
wb <- loadWorkbook(local_database_path)
writeData(wb, sheet = tab, x = local_database[[tab]])
local_database = database_data
tab = "Receiving"
# Update sheet in excel file
wb <- loadWorkbook(local_database_path)
writeData(wb, sheet = tab, x = local_database[[tab]])
protectWorksheet(wb, sheet = tab, password = "armmorlab2023!")
nrows <- nrow(readWorkbook(local_database_path, sheet = "Modifications"))
data_to_append <- data.frame(DateTime = format(Sys.time(), "%Y-%m-%d %H:%M:%S"), Tab = tab)
writeData(wb, sheet = "Modifications", x = data_to_append, startRow = nrows + 2, colNames = FALSE)
protectWorksheet(wb, sheet = "Modifications", password = "armmorlab2023!")
saveWorkbook(wb, local_database_path, overwrite = TRUE)
data_to_append
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
install.pachated("rChoiceDialogs")
install.packages("rChoiceDialogs")
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
?warning
?warning
runApp()
